```python
import redis
import json
```


```python
r = redis.Redis(
    host='redis',
    port=6379,
    db=0,
    decode_responses=True)

r.ping()
```




    True




```python
actual_id = 1

def next_id():
    global actual_id
    id = "pedido_" + str(actual_id).zfill(3)
    actual_id = actual_id+ 1
    return id
```


```python
def agregar_pedido(cliente,producto,urg):
    dic = {"id":next_id(),"cliente":cliente,"producto":producto,"cantidad":1,"urgente":False}

    if urg == True:
        dic = {"id":next_id(),"cliente":cliente,"producto":producto,"cantidad":1,"urgente":True}
        dic_json = json.dumps(dic)
        r.lpush("Pedidos",dic_json)
    else:
        dic_json = json.dumps(dic)    
        r.rpush("Pedidos",dic_json) 
    

```


```python
def procesar_pedido():
    dic = r.lpop("Pedidos")
    print("Se está procesando el pedido",dic)
    dic = json.loads(dic)
    return dic  
```


```python
for i in range(5):
    cliente = input("Como se llama el cliente")
    producto = input("Producto")
    urg = input("¿Es un pedido urgente?")
    if urg == "Si":
        urg = True
    else:
        urg = False 
    agregar_pedido(cliente,producto,urg)
```


```python
print(r.lrange(name="Pedidos",start=0,end=-1))
```

    ['{"id": "pedido_001", "cliente": "Jose", "producto": "qwe", "cantidad": 1, "urgente": false}', '{"id": "pedido_002", "cliente": "qw", "producto": "eq", "cantidad": 1, "urgente": false}', '{"id": "pedido_003", "cliente": "qwe", "producto": "qww", "cantidad": 1, "urgente": false}', '{"id": "pedido_004", "cliente": "we", "producto": "qwe", "cantidad": 1, "urgente": false}', '{"id": "pedido_005", "cliente": "eqw", "producto": "eq", "cantidad": 1, "urgente": false}']



```python
for i in range(2):
    cliente = input("Como se llama el cliente")
    urg = input("¿Es un pedido urgente?")
    if urg == "Si":
        urg = True
    else:
        urg = False 
    agregar_pedido(cliente,producto,urg)
```


```python
for i in range(r.llen("Pedidos")):
    pedido = procesar_pedido()
```

    Se está procesando el pedido {"id": "pedido_001", "cliente": "Jose", "producto": "qwe", "cantidad": 1, "urgente": false}
    Se está procesando el pedido {"id": "pedido_002", "cliente": "qw", "producto": "eq", "cantidad": 1, "urgente": false}
    Se está procesando el pedido {"id": "pedido_003", "cliente": "qwe", "producto": "qww", "cantidad": 1, "urgente": false}
    Se está procesando el pedido {"id": "pedido_004", "cliente": "we", "producto": "qwe", "cantidad": 1, "urgente": false}
    Se está procesando el pedido {"id": "pedido_005", "cliente": "eqw", "producto": "eq", "cantidad": 1, "urgente": false}
    Se está procesando el pedido {"id": "pedido_006", "cliente": "eq", "producto": "eq", "cantidad": 1, "urgente": false}
    Se está procesando el pedido {"id": "pedido_007", "cliente": "qwe", "producto": "eq", "cantidad": 1, "urgente": false}



```python
cliente = input("Como se llama el cliente")
producto = input("Producto")
urg = input("¿Es un pedido urgente?")
if urg == "Si":
    urg = True
else:
    urg = False 
agregar_pedido(cliente,producto,urg)
```
